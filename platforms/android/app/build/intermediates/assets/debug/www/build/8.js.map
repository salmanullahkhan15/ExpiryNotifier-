{"version":3,"sources":["../../src/pages/auth/auth.module.ts","../../src/pages/auth/auth.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AuthPage } from './auth';\n\n@NgModule({\n  declarations: [\n    AuthPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AuthPage),\n  ],\n})\nexport class AuthPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/auth.module.ts","import { Component, ViewChild  } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Slides, LoadingController  } from 'ionic-angular';\nimport { User } from '../../models/user';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { UserProvider } from '../../providers/user/user';\nimport { ToastController } from 'ionic-angular';\n\n@IonicPage()\n@Component({\n  selector: 'page-auth',\n  templateUrl: 'auth.html',\n})\nexport class AuthPage {\n  \n  @ViewChild(Slides) slides: Slides;\n  heading: string = \"ICA Shopping\";\n  user = {} as User;\n  constructor(public navCtrl: NavController, public navParams: NavParams, \n    private afAuth: AngularFireAuth, private afs: AngularFirestore,\n    private loadingCtrl: LoadingController, private userService: UserProvider, \n    public toastCtrl: ToastController) {\n      \n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad AuthPage');\n  }\n\n  toMainSlide(){\n    this.heading = \"ICA Shopping\";\n    this.slides.slideTo(0);\n  }\n\n  toRegister(){\n    this.heading = \"Registration Page\";\n    this.slides.slideTo(1);\n  }\n\n  RegisterUser(user: User){\n    try {\n      \n      if(user.name && user.password && user.email){\n        let loading = this.loadingCtrl.create({\n          content: 'Please wait...',\n          dismissOnPageChange: true\n        });\n  \n        loading.present();\n    \n        this.afAuth.auth.createUserWithEmailAndPassword(user.email.trim(), user.password.trim())\n        .then(res => {\n          if(res && res.user.uid && res.user.email){\n            this.afs.collection<User>('Users').doc(res.user.uid).set({\n              name: user.name,\n              gender: user.gender != null?user.gender:null,\n              address: user.address != null?user.address:null,\n              family: res.user.uid+\"_family\"\n            }).then(() => {\n              this.afs.collection('Items').doc(res.user.uid+\"_family\").set({\n                items: []\n              }).then(() => {\n                user.id = res.user.uid;\n                user.family = res.user.uid+\"_family\";\n                this.userService.setCurrentUser(user);\n                console.log(JSON.stringify(user));\n                this.navCtrl.setRoot('HomePage');\n              });\n            });\n          }\n        })\n        .catch(e => {\n          loading.dismiss();\n          this.toastCtrl.create({\n            message: 'Error: '+e.message,\n            duration: 3000,\n          }).present();\n        });\n      }else{\n        this.toastCtrl.create({\n          message: 'Please Fill Required Inputs',\n          duration: 3000,\n        }).present();\n      }\n      \n      //loading.dismiss();\n    } catch (e) {\n      alert('Error: '+e.message);\n    }\n  }\n\n  toLogin(){\n    this.heading = \"Login Page\";\n    this.slides.slideTo(2);\n  }\n\n  LoginUser(user: User){\n    try {\n      if(user.email && user.password){\n        let loading = this.loadingCtrl.create({\n          content: 'Please wait...',\n          dismissOnPageChange: true\n        });\n    \n        loading.present(); \n  \n        this.afAuth.auth.signInWithEmailAndPassword(user.email.trim(), user.password.trim())\n        .then(res => {\n          if(res && res.user.uid && res.user.email){\n            \n            let sub = this.afs.doc<User>('Users/'+res.user.uid).valueChanges()\n            .subscribe( user => {\n              console.log('User Found during Auth: '+user.name)\n              user.id = res.user.uid;\n              this.userService.setCurrentUser(user);\n              sub.unsubscribe();\n              this.navCtrl.setRoot('HomePage');\n            })\n          }\n        })\n        .catch(e => {\n          loading.dismiss();\n          this.toastCtrl.create({\n            message: 'Error: '+e.message,\n            duration: 3000,\n          }).present();\n        });\n        //loading.dismiss();\n      }else{\n        this.toastCtrl.create({\n          message: 'Please Fill Required Inputs',\n          duration: 3000,\n        }).present();\n      }\n    } catch (e) {\n      alert(\"Error: \"+e.message);\n    }\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/auth.ts"],"sourceRoot":""}